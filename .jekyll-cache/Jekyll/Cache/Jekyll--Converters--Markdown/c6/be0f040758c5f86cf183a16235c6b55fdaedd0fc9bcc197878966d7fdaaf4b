I"‹E<h1 id="django--ant-design-vue-æ­å»ºwebå¹³å°å‰åç«¯æ•´åˆ">Django + Ant Design Vue æ­å»ºwebå¹³å°â€”â€”å‰åç«¯æ•´åˆ</h1>

<ul>
  <li>ç³»ç»Ÿ ubuntu2004</li>
  <li>Dockerå†…æ­å»ºï¼ˆå¯é€‰ï¼‰</li>
</ul>

<h2 id="djangoå®‰è£…ä¸åˆå§‹åŒ–">Djangoå®‰è£…ä¸åˆå§‹åŒ–</h2>

<h3 id="æœ¬åœ°å®‰è£…">æœ¬åœ°å®‰è£…</h3>

<p>å®‰è£…django</p>

<blockquote>
  <p>è‡ªè¡Œå®‰è£…python3 åŠ python3-pipï¼Œæœ¬ç¯å¢ƒpythonç‰ˆæœ¬3.8.10ï¼Œå»ºè®®ç‰ˆæœ¬3.6åŠä»¥ä¸Š</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pip3 <span class="nb">install </span>django
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ£€æŸ¥djangoç‰ˆæœ¬</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>Python 3.8.10 <span class="o">(</span>default, Sep 28 2021, 16:10:42<span class="o">)</span>
<span class="o">[</span>GCC 9.3.0] on linux
Type <span class="s2">"help"</span>, <span class="s2">"copyright"</span>, <span class="s2">"credits"</span> or <span class="s2">"license"</span> <span class="k">for </span>more information.
<span class="o">&gt;&gt;&gt;</span> import django
<span class="o">&gt;&gt;&gt;</span> django.get_version<span class="o">()</span>
<span class="s1">'3.2.8'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ–°å»ºé¡¹ç›®</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>python3 <span class="nt">-m</span> django startproject mysite
</pre></td></tr></tbody></table></code></pre></div></div>

<p>åˆå§‹åŒ–ç»“æ„å¦‚ä¸‹</p>

<blockquote>
  <p>README.mdä¸æ˜¯è¯¥å‘½ä»¤ç”Ÿæˆï¼Œè‡ªå·±æ·»åŠ </p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>
â”œâ”€â”€ README.md
â”œâ”€â”€ manage.py
â””â”€â”€ mysite
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ asgi.py
    â”œâ”€â”€ settings.py
    â”œâ”€â”€ urls.py
    â””â”€â”€ wsgi.py
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¯åŠ¨</p>

<blockquote>
  <ul>
    <li>å¯ä»¥ä¸ä½¿ç”¨ <your_id>:<your_port> ï¼Œç›´æ¥python3 manage.py runserverï¼Œç›´æ¥è®¿é—® http://127.0.0.1:8000/</your_port></your_id></li>
    <li>å¦‚æœæŒ‡å®šipï¼Œéœ€è¦ä¿®æ”¹ settings.py ï¼Œåœ¨ ALLOWED_HOSTS åˆ—è¡¨ä¸­æ·»åŠ æŒ‡å®šçš„ip</li>
  </ul>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>python3 manage.py runserver &lt;your_id&gt;:&lt;your_port&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¯åŠ¨æˆåŠŸåè®¿é—® http://<your_id>:<your_port>/ï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå°ç«ç®­</your_port></your_id></p>

<h3 id="dockerå†…å®‰è£…">dockerå†…å®‰è£…</h3>

<blockquote>
  <p>åŸºç¡€é•œåƒä¸ºdocker hubè·å–çš„ubuntu2004</p>
</blockquote>

<p>è¿è¡Œdocker</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker run <span class="nt">-it</span> <span class="nt">-v</span> &lt;code_path&gt;:&lt;code_path&gt; <span class="nt">-p</span> 80:8001 &lt;images&gt; /bin/bash
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>é€šè¿‡-pæ˜ å°„dockerå†…ç«¯å£</p>

  <p>dockerå†…å®‰è£…djangoæ–¹æ³•åŒæœ¬åœ°</p>
</blockquote>

<p>åœ¨dockerå†…è¿è¡Œ</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">cd</span> &lt;code_path&gt;
python3 manage.py runserver 0.0.0.0:8001
</pre></td></tr></tbody></table></code></pre></div></div>

<p>åœ¨æµè§ˆå™¨è®¿é—® <å®¿ä¸»æœºip>:80 ï¼Œæ•ˆæœä¸æœ¬åœ°è¿è¡Œä¸€è‡´</å®¿ä¸»æœºip></p>

<blockquote>
  <p>é»˜è®¤æ¥ä¸‹æ¥çš„æ“ä½œå‡åœ¨docker ä¸­è¿›è¡Œ</p>
</blockquote>

<h2 id="ant-design-vueç¯å¢ƒæ­å»º">Ant Design Vueç¯å¢ƒæ­å»º</h2>

<h3 id="å®‰è£…æ„å»ºå·¥å…·npmcnpm">å®‰è£…æ„å»ºå·¥å…·npm/cnpm</h3>

<p>å®‰è£…nodejs</p>

<blockquote>
  <p>å®‰è£…è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé€‰åœ°åŒºï¼ŒAsia Shanghai</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>apt <span class="nb">install </span>nodejs
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ£€æŸ¥nodeç‰ˆæœ¬</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>node <span class="nt">--version</span>
v10.19.0
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å®‰è£…npm</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>apt <span class="nb">install </span>npm
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ£€æŸ¥npmç‰ˆæœ¬</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>npm <span class="nt">--version</span>
6.14.4
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä½¿ç”¨å›½å†…æ·˜å®ä»“åº“</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>npm config <span class="nb">set </span>registry https://registry.npm.taobao.org
</pre></td></tr></tbody></table></code></pre></div></div>

<p>nodeå‡çº§</p>

<blockquote>
  <p>å½“å‡ºç°npmä¸æ”¯æŒnodeç‰ˆæœ¬çš„æƒ…å†µä¸‹</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>npm <span class="nt">--version</span>
npm WARN npm npm does not support Node.js v10.19.0
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ‰§è¡Œ</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>npm <span class="nb">install </span>n <span class="nt">-g</span>
n latest
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ£€æŸ¥ç‰ˆæœ¬</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>node <span class="nt">-v</span> <span class="o">&amp;&amp;</span> npm <span class="nt">-v</span>
v16.11.0
8.0.0
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="å‰ç«¯ä»£ç æ„å»º">å‰ç«¯ä»£ç æ„å»º</h3>

<p>å…‹éš† ant design vue proçš„ä»£ç </p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>git clone <span class="nt">--depth</span><span class="o">=</span>1 https://github.com/vueComponent/ant-design-vue-pro.git vue-frontend
</pre></td></tr></tbody></table></code></pre></div></div>

<p>npmå‡çº§</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>npm <span class="nb">install</span> <span class="nt">-g</span> npm
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ‰§è¡Œinstall</p>

<blockquote>
  <p>æ‰§è¡Œå®Œä¹‹åå¯ä»¥çœ‹åˆ°æ–‡ä»¶å¤¹ä¸‹æ–°å¢äº†node_modulesæ–‡ä»¶å¤¹åŠpackage-lock.jsonæ–‡ä»¶</p>

  <p>node_modulesæ–‡ä»¶å¤¹é‡Œæ˜¯å®‰è£…çš„æ‰€æœ‰ä¾èµ–åº“ï¼Œæ¯”è¾ƒå¤§ï¼Œå¦‚æœå‰ç«¯æ˜¯ç”¨gitç®¡ç†å»ºè®®åœ¨.gitignoreæ–‡ä»¶ä¸­è¿‡æ»¤</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>npm <span class="nb">install</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¯åŠ¨</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>npm run serve
</pre></td></tr></tbody></table></code></pre></div></div>

<p>è®¿é—®ç«¯å£å¯ä»¥çœ‹åˆ°ant design vue proçš„ç•Œé¢ï¼Œç¯å¢ƒæ­å»ºæˆåŠŸ</p>

<h2 id="å‰åå°æ•´åˆ">å‰åå°æ•´åˆ</h2>

<p>å°† vue-frontend æ”¾åˆ°ä¸ mysite åŒçº§ï¼Œç»“æ„å¦‚ä¸‹</p>

<blockquote>
  <p>å¦‚æœåå°ä½¿ç”¨gitç®¡ç†ï¼Œå¯åœ¨.gitignoreä¸­å°†vue-frontendè¿‡æ»¤</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>./
â”œâ”€â”€ README.md
â”œâ”€â”€ db.sqlite3
â”œâ”€â”€ manage.py
â”œâ”€â”€ mysite
â””â”€â”€ vue-fronted  <span class="c"># å‰ç«¯æ–‡ä»¶</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>vue-fronted/vue.config.jsä¿®æ”¹</p>

<blockquote>
  <p>é»˜è®¤ npm run buildä¼šå°†csså’Œjsæ–‡ä»¶å¤¹ç”Ÿæˆåœ¨distç›®å½•ä¸‹ï¼Œåç»­éƒ¨ç½²é™æ€èµ„æºå…¨éƒ¨ä»staticä¸‹è·å–ï¼Œä¸ºäº†ç»Ÿä¸€ï¼Œå¢åŠ å¦‚ä¸‹é…ç½®ï¼Œè®©csså’Œjsç”Ÿæˆåœ¨ dist/static ä¸‹</p>
</blockquote>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">// vue.config.js</span>
<span class="kd">const</span> <span class="nx">vueConfig</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// npm run build dist dir config</span>
  <span class="na">runtimeCompiler</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">publicPath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">outputDir</span><span class="p">:</span> <span class="dl">'</span><span class="s1">dist</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">assetsDir</span><span class="p">:</span> <span class="dl">'</span><span class="s1">static</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">indexPath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">index.html</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">filenameHashing</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">configureWebpack</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">},</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ‰§è¡Œ</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>npm update
npm run build
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç”Ÿæˆé™æ€æ–‡ä»¶å¤¹dist</p>

<p>mysite/settings.py æ·»åŠ templateé…ç½®</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">TEMPLATES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="p">...</span>
        <span class="c1"># å¢åŠ staticè·¯å¾„åŠå‰ç«¯index.htmlè·¯å¾„
</span>        <span class="s">'DIRS'</span><span class="p">:</span> <span class="p">[</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s">'static'</span><span class="p">),</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s">'vue-fronted/dist'</span><span class="p">)],</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>mysite/settings.py æ·»åŠ é™æ€æ–‡ä»¶è·¯ç”±</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>

<span class="n">STATICFILES_DIRS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s">'static/'</span><span class="p">),</span>
    <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s">"vue-fronted/dist/static/"</span><span class="p">),</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>mysite/urls.py æ·»åŠ vueå·¥ç¨‹å…¥å£</p>

<blockquote>
  <p>ant design vue proå…¥å£ä¸ºç”Ÿæˆçš„dist/index.html</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">include</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.conf.urls.static</span> <span class="kn">import</span> <span class="n">static</span>
<span class="kn">from</span> <span class="nn">django.views.generic.base</span> <span class="kn">import</span> <span class="n">TemplateView</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># åå° API Here
</span>    <span class="c1"># vueå…¥å£
</span>    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s">'^'</span><span class="p">,</span> <span class="n">TemplateView</span><span class="p">.</span><span class="n">as_view</span><span class="p">(</span><span class="n">template_name</span><span class="o">=</span><span class="s">"index.html"</span><span class="p">)),</span>
<span class="p">]</span> <span class="o">+</span> <span class="n">static</span><span class="p">(</span><span class="n">settings</span><span class="p">.</span><span class="n">STATIC_URL</span><span class="p">,</span> <span class="n">document_root</span><span class="o">=</span><span class="n">settings</span><span class="p">.</span><span class="n">STATICFILES_DIRS</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å¯åŠ¨ Django</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>python3 manage.py runserver 0.0.0.0:9997
</pre></td></tr></tbody></table></code></pre></div></div>

<p>é€šè¿‡è®¿é—® 9997 ç«¯å£çœ‹åˆ° ant design vue proçš„ç•Œé¢ï¼Œåˆ™å‰åå°æ•´åˆæˆåŠŸ</p>

<h2 id="å®˜æ–¹æ–‡æ¡£å‚è€ƒèµ„æ–™">å®˜æ–¹æ–‡æ¡£/å‚è€ƒèµ„æ–™</h2>

<ul>
  <li>Djangoå®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.djangoproject.com/zh-hans/3.2/</li>
  <li>Ant Design Vue Proï¼šhttps://pro.antdv.com/docs/getting-started</li>
  <li>Ant Design Vueï¼šhttps://1x.antdv.com/docs/vue/introduce-cn/</li>
</ul>

:ET